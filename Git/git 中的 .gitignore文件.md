# .gitignore备忘录

## 概念

`.gitignore` - 在`Git`中指定要忽略的`untracked`的文件集。

## 作用

`.gitignore`文件指定需要`untracked`的文件。已经被==Git==跟踪的文件不会收到影响。

`.gitignore`文件中的每一行都指定一个模式。在决定是否忽略该路径时，==Git==通常会检查`.gitignore`来自多个源的模式，按照一下优先级从高到低决定匹配模式（在一个优先级内，最后匹配的模式决定结果）：

- 从命令行读取支持模式的相关命令。

- 从`.gitignore`和与其路径相同的目录或者任何上一级目录（直到当前项目的根目录）中的文件读取模式。高级目录文件中的模式将被低级目录文件的模式所覆盖，直到当前目录。这些模型以`.gitignore`文件的文件位置进行匹配。项目通常在其存储库中包含此类`.gitignore`文件，其中包含作为项目构建的一部分生成的文件的模式。

- `$GIT_DIR/info/exclude`中的模式

- 从配置变量指定的文件中读取的模式`core.excludesFile`。放置模式的文件取决于模式的使用方式。

- 受版本控制并通过克隆分发到其他存储库的模式（即所有开发人员都希望忽略的`.gitignore`文件）应该放入一个文件中。

- 特定存储库不需要与其他相关存储库共享的模式（例如，位于仓库内但特定于一个用户的工作流的辅助文件）应该放入`$GIT_DIR/info/exclude`文件中。

- 用户希望 Git 在所有情况下忽略的模式（例如，由用户选择的编辑器生成的备份或临时文件）通常会放入用户的 .git 文件中指定的文件 `core.excludesFile`中`~/.gitconfig`。它的默认值是 `$XDG_CONFIG_HOME/git/ignore`。如果 `$XDG_CONFIG_HOME`未设置或为空，则使用 $HOME/.config/git/ignore 代替。

底层 ==Git== 管道工具，例如 `git ls-files`和`git read-tree`，读取`.gitignore`由命令行选项指定的模式，或从命令行选项指定的文件中读取 。更高级别的 ==Git== 工具，例如`git status`*和`git add`，使用来自上面指定的来源的模式。

## 语法

- 空行不匹配任何文件，作为可读性的分隔符。
- 以`#`开头的行即注释行将被忽略。
- 在前面添加正斜杠`/`来避免递归。
- 可以在后面添加正斜杠`/`来忽略文件夹，例如`build/`即忽略build文件夹。
- 可以使用`!`来否定忽略，即比如在前面用了`*.apk`，然后使用`!a.apk`，则这个a.apk不会被忽略。
- `*`用来匹配零个或多个字符，如`*.[oa]`忽略所有以".o"或".a"结尾，`*~`忽略所有以`~`结尾的文件（这种文件通常被许多编辑器标记为临时文件）；`[]`用来匹配括号内的任一字符，如`[abc]`，也可以在括号内加连接符，如`[0-9]`匹配0至9的数；`?`用来匹配单个字符（类似于正则表达式）。

与完整路径名匹配的模式中的两个连续星号 `**`可能具有特殊含义：

- 前面 " `**`" 后跟斜杠表示在所有目录中匹配。例如，" `**/foo`" 匹配文件或目录 " `foo`" 的任何位置，与模式 " `foo`"相同。" `**/foo/bar`" 匹配文件或目录 " `bar`" 直接位于目录 " `foo`"下的任何位置。
- 位于后面的“ `/**`”匹配路径里面的所有内容。例如，“ `abc/**`”匹配目录“ `abc`”内的所有文件，相对于`.gitignore`文件的位置，具有无限深度。
- 斜杠后跟两个连续的星号，然后斜杠匹配零个或多个目录。例如，“ `a/**/b`”匹配“ `a/b`”、“ `a/x/b`”、“ `a/x/y/b`”等。
- 其他连续的星号被视为常规星号，将根据之前的规则进行匹配。

## 注意

`gitignore` 文件的目的是确保 ==Git== 未跟踪的某些文件保持未跟踪状态。

要停止跟踪当前跟踪的文件，使用 `git rm --cached [文件名]`删除缓存。

==Git== 在访问`.gitignore`工作树中的文件时不遵循上述规则。这样在从索引或树访问文件与从文件系统访问文件时，可以保持行为一致。

## Demo

```shell
# 忽略 .a 文件
*.a
# 但否定忽略 lib.a, 尽管已经在前面忽略了 .a 文件
!lib.a
# 仅在当前目录下忽略 TODO 文件， 但不包括子目录下的 subdir/TODO
/TODO
# 忽略 build/ 文件夹下的所有文件
build/
# 忽略 doc/notes.txt, 不包括 doc/server/arch.txt
doc/*.txt
# 忽略所有的 .pdf 文件 在 doc/ directory 下的
doc/**/*.pdf
```